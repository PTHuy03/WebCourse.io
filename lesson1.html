<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Giáo trình khóa học</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    />

    <!-- Project CSS -->
    <link rel="stylesheet" href="public/css/globals.css" />
    <link rel="stylesheet" href="public/css/style.css" />
    <link rel="stylesheet" href="public/css/styleguide.css" />
    <link rel="stylesheet" href="public/css/detail.css" />

    <style>
      /* Reuse styles from detail.html */
      body {
        font-family: Arial, sans-serif;
        margin: 0;
      }
      .drawer-frame {
        position: fixed;
        top: 0;
        left: 0;
        width: 260px;
        height: 100vh;
        border: none;
        z-index: 1000;
      }
      .main-wrapper {
        margin-left: 260px;
        padding: 20px;
      }
      .course-banner {
        background: linear-gradient(90deg, #344c84 36%, #000d29 100%);
        color: #fff;
        border-radius: 20px;
        padding-left: 20px;
        padding-right: 20px;
        padding-top: 5px;
        padding-bottom: 5px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        min-height: 280px;
      }
      .course-banner-left {
        width: 60%;
        padding-right: 20px;
      }
      .course-banner-right {
        width: 40%;
        text-align: center;
        position: relative;
        overflow: hidden;
      }
      .course-banner h1 {
        font-size: 32px;
        font-weight: bold;
        margin-bottom: 15px;
      }
      .course-banner p {
        font-size: 16px;
        margin-bottom: 5px;
      }
      .course-banner .author,
      .course-banner .students {
        font-size: 14px;
        margin-bottom: 10px;
      }
      .course-banner .rating {
        color: #ffd700;
        font-size: 16px;
        display: inline-block;
        margin-left: 10px;
      }
      .course-banner-right img {
        max-width: 300px;
        width: 100%;
        height: auto;
        opacity: 0.8;
        object-fit: contain;
      }
      .course-banner-right p {
        font-size: 24px;
        font-weight: bold;
        margin-top: 10px;
      }
      @media (max-width: 768px) {
        .course-banner {
          flex-direction: column;
          align-items: flex-start;
          min-height: auto;
        }
        .course-banner-left {
          width: 100%;
          padding-right: 0;
          margin-bottom: 20px;
        }
        .course-banner-right {
          width: 100%;
          text-align: center;
        }
        .course-banner-right img {
          max-width: 200px;
        }
      }
      @media (max-width: 576px) {
        .course-banner h1 {
          font-size: 24px;
        }
        .course-banner p {
          font-size: 14px;
        }
        .course-banner .author,
        .course-banner .students {
          font-size: 12px;
        }
        .course-banner .rating {
          font-size: 14px;
        }
      }
      .group27 {
        background-color: #002c83;
        border-radius: 10px;
        padding: 20px;
        color: #fff;
        position: relative;
        overflow: hidden;
        margin-bottom: 20px;
      }
      .group27 img.bg {
        width: 100%;
        border-radius: 10px;
        opacity: 0.2;
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        object-fit: cover;
      }
      .group27-content {
        position: relative;
        z-index: 1;
        line-height: 2;
      }
      .group27-icons {
        display: flex;
        gap: 20px;
        margin-top: 20px;
      }
      .group27-icons img {
        width: 50px;
        height: 50px;
      }
    </style>
  </head>
  <body>
    <!-- Drawer Sidebar -->
    <iframe src="drawer.html" class="drawer-frame"></iframe>

    <div class="main-wrapper">
      <div class="container-fluid">
        <div class="row">
          <!-- Main Content -->
          <div class="col-md-8">
            <section class="course-banner mb-4">
              <div class="course-banner-left">
                <h1>Lập trình Python cơ bản</h1>
                <p style="line-height: calc(1.5em); font-size: 16px">
                  Khóa học lập trình Python cơ bản với các bài tập và lý thuyết
                  dễ hiểu, học xong bạn có thể tự tin để tới với các chủ đề nâng
                  cao hơn của Python.
                </p>
                <div class="author d-flex align-items-center">
                  <span class="me-3">
                    Tác giả: <span style="color: blue">locnguyen305</span>
                  </span>
                  <div class="text-warning">
                    <i class="bi bi-star-fill fs-5"></i>
                    <i class="bi bi-star-fill fs-5"></i>
                    <i class="bi bi-star-fill fs-5"></i>
                    <i class="bi bi-star-fill fs-5"></i>
                    <i class="bi bi-star-fill fs-5"></i>
                  </div>
                </div>
                <p class="students">1384 Học viên</p>
              </div>
              <div class="course-banner-right">
                <img
                  src="public/images/course-python-banner.png"
                  alt="Python Logo"
                />
              </div>
            </section>

            <!-- Tabs -->
            <section class="d-flex gap-4 border-bottom mb-4 pb-2">
              <a
                href="detail1.html"
                class="fw-bold pb-2 text-decoration-none text-dark"
                >Giới thiệu</a
              >
              <a
                href="lesson1.html"
                class="fw-bold border-bottom border-primary pb-2 text-decoration-none text-dark"
                >Giáo trình</a
              >
            </section>

            <!-- Curriculum Content -->
            <section class="mb-4">
              <h2>Nội dung khóa học</h2>
              <p>11 chương 49 bài giảng 4 tuần</p>
              <div class="row mt-4">
                <!-- Left: Chapter List -->
                <div class="col-md-4 mb-3">
                  <div class="list-group" id="chapterList">
                    <button
                      class="list-group-item list-group-item-action active"
                      data-chapter="1"
                    >
                      Chương 1
                    </button>
                    <button
                      class="list-group-item list-group-item-action"
                      data-chapter="2"
                    >
                      Chương 2
                    </button>
                    <button
                      class="list-group-item list-group-item-action"
                      data-chapter="3"
                    >
                      Chương 3
                    </button>
                    <button
                      class="list-group-item list-group-item-action"
                      data-chapter="4"
                    >
                      Chương 4
                    </button>
                    <button
                      class="list-group-item list-group-item-action"
                      data-chapter="5"
                    >
                      Chương 5
                    </button>
                    <button
                      class="list-group-item list-group-item-action"
                      data-chapter="6"
                    >
                      Chương 6
                    </button>
                    <button
                      class="list-group-item list-group-item-action"
                      data-chapter="7"
                    >
                      Chương 7
                    </button>
                    <button
                      class="list-group-item list-group-item-action"
                      data-chapter="8"
                    >
                      Chương 8
                    </button>
                    <button
                      class="list-group-item list-group-item-action"
                      data-chapter="9"
                    >
                      Chương 9
                    </button>
                  </div>
                </div>
                <!-- Right: Chapter Details -->
                <div class="col-md-8" id="chapterContent">
                  <div class="d-flex flex-column gap-2">
                    <a
                      href="lesson1.html?lesson=intro-python"
                      class="p-2 border rounded text-decoration-none text-dark"
                    >
                      Giới thiệu Python và chú thích
                      <div class="d-flex gap-2 mt-2">
                        <i class="bi bi-clock"></i>
                        <span>15 phút</span>
                      </div>
                    </a>
                    <a
                      href="lesson1.html?lesson=hello-world"
                      class="p-2 border rounded text-decoration-none text-dark"
                    >
                      Viết chương trình Hello World đầu tiên
                      <div class="d-flex gap-2 mt-2">
                        <i class="bi bi-clock"></i>
                        <span>15 phút</span>
                      </div>
                    </a>
                    <a
                      href="lesson1.html?lesson=print-exercise"
                      class="p-2 border rounded text-decoration-none text-dark"
                    >
                      Bài tập cơ bản với câu lệnh print
                      <div class="d-flex gap-2 mt-2">
                        <i class="bi bi-clock"></i>
                        <span>20 phút</span>
                      </div>
                    </a>
                    <a
                      href="lesson1.html?lesson=sum-two-numbers"
                      class="p-2 border rounded text-decoration-none text-dark"
                    >
                      Bài tập tính tổng hai số
                      <div class="d-flex gap-2 mt-2">
                        <i class="bi bi-clock"></i>
                        <span>20 phút</span>
                      </div>
                    </a>
                    <a
                      href="lesson1.html?lesson=python-comment"
                      class="p-2 border rounded text-decoration-none text-dark"
                    >
                      Comment trong Python
                      <div class="d-flex gap-2 mt-2">
                        <i class="bi bi-clock"></i>
                        <span>15 phút</span>
                      </div>
                    </a>
                  </div>
                </div>
              </div>
              <script>
                const chapterButtons = document.querySelectorAll(
                  "#chapterList button"
                );
                const chapterContent =
                  document.getElementById("chapterContent");

                function getQueryParam(param) {
                  const urlParams = new URLSearchParams(window.location.search);
                  return urlParams.get(param);
                }

                async function loadLessons() {
                  try {
                    const response = await fetch(
                      `http://localhost:3000/api/courses/67f74eac9e18aa8b48794ada`
                    );
                    const course = await response.json();
                    const lessons = course.lessons || [];

                    // Group lessons by chapter
                    const chapters = {};
                    lessons.forEach((lesson) => {
                      const chap = lesson.chapter || 1;
                      if (!chapters[chap]) chapters[chap] = [];
                      chapters[chap].push(lesson);
                    });

                    // Render initial chapter
                    renderChapter(Object.keys(chapters)[0], chapters);

                    // Add event listeners
                    chapterButtons.forEach((btn) => {
                      btn.addEventListener("click", () => {
                        chapterButtons.forEach((b) =>
                          b.classList.remove("active")
                        );
                        btn.classList.add("active");
                        const chap = btn.getAttribute("data-chapter");
                        renderChapter(chap, chapters);
                      });
                    });
                  } catch (error) {
                    console.error("Error loading lessons:", error);
                  }
                }

                function renderChapter(chap, chapters) {
                  let lessons = chapters[chap] || [];
                  lessons = lessons.sort((a, b) => a.order - b.order);
                  chapterContent.innerHTML = "";

                  if (lessons.length === 0) {
                    chapterContent.innerHTML = `<p>Nội dung chương ${chap} sẽ được cập nhật.</p>`;
                  } else {
                    lessons.forEach((lesson) => {
                      const a = document.createElement("a");
                      a.href = `lesson1.html?lesson=${lesson._id}`;
                      a.className =
                        "p-2 border rounded text-decoration-none text-dark d-block mb-2";
                      a.innerHTML = `
                        ${lesson.title}
                        <div class="d-flex gap-2 mt-2">
                          <i class="bi bi-clock"></i>
                          <span>15 phút</span>
                        </div>
                      `;
                      chapterContent.appendChild(a);
                    });
                  }
                }

                loadLessons();
              </script>
            </section>
          </div>

          <!-- Right Sidebar -->
          <div class="col-md-4" style="min-height: 300px">
            <div class="group27 mb-4">
              <img
                src="public/images/group27-bg.png"
                alt="Background"
                class="bg"
              />
              <div class="group27-content">
                <h3>Miễn phí</h3>
                <h4>Thông tin khóa học</h4>
                <div class="course-info">
                  <p>
                    <img src="public/images/group27-icon1.svg" alt="Icon 1" /> 4
                    tuần
                  </p>
                  <p>
                    <img src="public/images/group27-icon2.svg" alt="Icon 2" />
                    49 bài lập trình
                  </p>
                  <p>
                    <img src="public/images/group27-icon3.svg" alt="Icon 3" />
                    Chứng chỉ khi hoàn thành 100% khóa học
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
